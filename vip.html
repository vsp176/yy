<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VisionPay - VIP Membership</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet"/>
    
    <style>
        :root {
            --bg-color: #000000;
            --card-color: #111111;
            --accent-color: #ff3b30;
            --border-color: #222222;
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Montserrat', sans-serif;
            --side-margin: 18px; 
            --side-padding: 20px; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg-color); color: #fff; font-family: var(--font-sans); padding-bottom: 120px; overflow-x: hidden; }

        /* ANIMASI KHUSUS KARTU PLAN */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shimmerBtn {
            0% { left: -150%; }
            30% { left: 150%; }
            100% { left: 150%; }
        }

        header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    padding: 15px 20px; 
    

    position: fixed; 
    top: 0; 
    left: 0;
    right: 0;
    

    background: #0a0a0a; 
    
    z-index: 1000; 
    
    border-bottom: 1px solid #151515; 
}
body { 
    padding-top: 75px;
    padding-bottom: 75px;
}
.header-icons a {
    text-decoration: none;
    color: #fff;
    display: flex;
    align-items: center;
}
.header-icons .icon-vip {
    color: var(--accent-color); /* Tetap merah untuk VIP */
}
.header-icons {
    display: flex;
    gap: 12px; /* Jarak antar tombol */
    align-items: center;
}

.icon-box {
    width: 40px;
    height: 40px;
    background-color: #1a1a1a; /* Warna box bulat (sedikit lebih terang dari header) */
    border-radius: 50%; /* Membuat jadi bulat sempurna */
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    transition: background 0.3s ease;
}

.icon-box:active {
    background-color: #252525; /* Efek saat ditekan */
}

.icon-box i {
    font-size: 20px; /* Ukuran ikon di dalam box */
    color: #ffffff;
}

        .container { padding: 0 var(--side-margin); margin-top: 15px; }
       .section-header { padding: 0 var(--side-margin); margin: 15px 0; }
        .section-header h3 { font-size: 15px; font-weight: 700; }

        /* VIP CARD STYLE */
        .vip-card {
            background: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 22px;
            margin-bottom: 20px;
            width: 100%;
            position: relative;
            overflow: hidden;
            opacity: 0; /* Untuk animasi */
            animation: fadeInUp 0.6s ease forwards;
        }

        .card-head { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 18px; }
        .plan-name { font-family: var(--font-serif); font-size: 28px; font-weight: 900; line-height: 1; color: #fff; }
        .plan-name span { display: block; font-family: var(--font-sans); font-size: 9px; letter-spacing: 2px; color: var(--accent-color); margin-top: 6px; font-weight: 700; }

        .plan-details { border-top: 1px solid var(--border-color); padding-top: 15px; }
        .detail-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .detail-row p { font-size: 11px; color: #888; }
        .detail-row span { font-size: 11px; font-weight: 600; color: #ddd; }
        .profit { color: #4cd964 !important; font-weight: 800 !important; }
        .profit-task { color: var(--accent-color) !important; font-weight: 700 !important; }

        /* BUTTON BERGABUNG DENGAN KILAUAN */
        .btn-join {
            width: 100%; margin-top: 18px; padding: 14px; border: none; border-radius: 12px;
            background: var(--accent-color); 
            color: #fff; font-weight: 700; font-size: 14px;
            cursor: pointer;
            font-family: var(--font-serif);
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(255,59,48,0.2);
        }

.btn-join::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -150%;
    width: 50%;
    height: 200%;
    background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.3), transparent);
    transform: rotate(30deg);
    animation: shimmerBtn 3.5s infinite;

    pointer-events: none; /* <<< INI PENTING */
}
.btn-join.disabled {
    background: #222 !important;
    color: #777 !important;
    cursor: not-allowed;
    box-shadow: none;
}

.btn-join.active {
    background: #0f9d58 !important;
    color: #fff !important;
    cursor: default;
    box-shadow: 0 0 15px rgba(15,157,88,0.4);
}
        /* HIGHLIGHT V7 */
        .glow-ultimate { border-color: rgba(255, 59, 48, 0.6); box-shadow: 0 0 20px rgba(255, 59, 48, 0.15); }
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.97); display: none; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(10px);
        }
        .popup-card {
            background: #000; border: 1px solid #222; width: 230px; padding: 35px 20px; border-radius: 30px; text-align: center;
            transform: scale(0.9); opacity: 0; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .popup-card.show { transform: scale(1); opacity: 1; }

        .spin-container { position: relative; width: 45px; height: 45px; margin: 0 auto 18px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .spinning-red { animation: spin 0.8s linear infinite; width: 45px; height: 45px; }
        .circle-bg { fill: none; stroke: #111; stroke-width: 4; }
        .circle-bar { fill: none; stroke: var(--accent-color); stroke-width: 4; stroke-dasharray: 80; stroke-dashoffset: 40; stroke-linecap: round; }
        
        .check-icon { font-size: 30px; color: var(--accent-color); display: none; margin-bottom: 15px; }
        .popup-card h3 { font-size: 14px; font-weight: 600; color: #fff; font-family: 'Playfair Display', serif; }
        .popup-card p { font-size: 10px; color: var(--text-muted); margin-top: 6px; }
        /* NAV BOTTOM IDENTIK */
        /* --- NAVBAR BAWAH STYLE ABANG (LEBIH TEGAS) --- */
.bottom-nav { 
    position: fixed; 
    bottom: 0; 
    left: 0; 
    right: 0; 
    background: #0a0a0a; 
    border-top: 1px solid #151515; 
    display: flex; 
    padding: 10px 0 15px; /* Tinggi standar yang nyaman */
    z-index: 1000; 
}

.nav-link { 
    flex: 1; 
    text-align: center; 
    text-decoration: none; 
    color: #666; /* Warna saat tidak aktif */
    font-size: 10px; 
    font-weight: 500; /* Ketebalan standar */
}

/* KHUSUS SAAT AKTIF: TEKS TEBAL & WARNA TERANG */
.nav-link.active { 
    color: #ff3b30; /* Warna merah solid */
}

.nav-link.active span {
    font-weight: 800; /* Teks jadi sangat tebal */
    font-size: 11px;  /* Sedikit lebih besar agar menonjol */
}

.nav-link i { 
    font-size: 24px; 
    display: block; 
    margin-bottom: 4px; 
    transition: 0.2s;
}

.nav-link.active i {
    color: #ff3b30; /* Ikon juga jadi merah terang */
}
    </style>
</head>
<body>

    <header>
    <a href="beranda.html">
        <img src="logo.jpg" alt="VisionPay" style="height: 40px; width: auto; display: block;">
    </a>
    
    <div class="header-icons">
        <a href="vip.html" class="icon-box">
            <i class="ri-vip-crown-fill"></i>
        </a>
        
        <a href="customer-service.html" class="icon-box">
            <i class="ri-customer-service-2-fill"></i>
        </a>
        
        <a href="film.html" class="icon-box">
            <i class="ri-video-line"></i>
        </a>
    </div>
</header>
    <div class="section-header">
        <h3>Level Vision</h3>
    </div>
    <div class="container">
            

        <div class="vip-card" style="animation-delay: 0.1s;">
            <div class="card-head"><div class="plan-name">Magang<span>TRIAL PLAN</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>3 Video</span></div>
                <div class="detail-row"><p>Hadiah Per Tugas</p><span class="profit-task">Rp 5.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>1 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 15.000</span></div>
            </div>
            <button class="btn-join" data-plan="MAGANG">Mulai Gratis</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.2s;">
            <div class="card-head"><div class="plan-name">V1<span>PREMIUM</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>3 Video</span></div>
                <div class="detail-row"><p>Hadiah Per Tugas</p><span class="profit-task">Rp 5.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 5.400.000</span></div>
            </div>
            <button class="btn-join" data-plan="V1">Mulai Rp 320.000</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.3s;">
            <div class="card-head"><div class="plan-name">V2<span>PREMIUM</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>5 Video</span></div>
                <div class="detail-row"><p>Hadiah Per Tugas</p><span class="profit-task">Rp 7.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total profit</p><span class="profit">Rp 12.680.000</span></div>
            </div>
            <button class="btn-join" data-plan="V2">Mulai Rp 780.000</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.4s;">
            <div class="card-head"><div class="plan-name">V3<span>EXECUTIVE</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>8 Video</span></div>
                <div class="detail-row"><p>Hadiah Per tugas</p><span class="profit-task">Rp 9.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 25.920.000</span></div>
            </div>
<button class="btn-join" data-plan="V3">Mulai Rp 1.820.000</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.5s;">
            <div class="card-head"><div class="plan-name">V4<span>EXECUTIVE</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>12 Video</span></div>
                <div class="detail-row"><p>Hadiah Per tugas</p><span class="profit-task">Rp 14.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 60.480.000</span></div>
            </div>
<button class="btn-join" data-plan="V4">Mulai Rp 3.290.000</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.6s;">
            <div class="card-head"><div class="plan-name">V5<span>ELITE</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>20 Video</span></div>
                <div class="detail-row"><p>Hadiah Per tugas</p><span class="profit-task">Rp 20.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 144.000.000</span></div>
            </div>
            <button class="btn-join" data-plan="V5">Mulai Rp 8.250.000</button>
        </div>

        <div class="vip-card" style="animation-delay: 0.7s;">
            <div class="card-head"><div class="plan-name">V6<span>ELITE</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>30 Video</span></div>
                <div class="detail-row"><p>Hadiah Per tugas</p><span class="profit-task">Rp 32.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 345.600.000</span></div>
            </div>
            <button class="btn-join" data-plan="V6">Mulai Rp 20.150.000</button>
        </div>

        <div class="vip-card glow-ultimate" style="animation-delay: 0.8s;">
            <div class="card-head"><div class="plan-name">V7<span>ULTIMATE</span></div></div>
            <div class="plan-details">
                <div class="detail-row"><p>Tugas Per Hari</p><span>45 Video</span></div>
                <div class="detail-row"><p>Hadiah Per tugas</p><span class="profit-task">Rp 55.000</span></div>
                <div class="detail-row"><p>Masa Aktif</p><span>360 Hari</span></div>
                <div class="detail-row"><p>Total Hadiah</p><span class="profit">Rp 891.000.000</span></div>
            </div>
            <button class="btn-join" data-plan="V7">Mulai Rp 50.450.000</button>
        </div>

    </div>

    <nav class="bottom-nav">
        <a href="beranda.html" class="nav-link"><i class="ri-home-5-line"></i><span>Beranda</span></a>
        <a href="vip.html" class="nav-link active"><i class="ri-vip-crown-line"></i><span>VIP Plan</span></a>
        <a href="film.html" class="nav-link"><i class="ri-video-line"></i><span>Film</span></a>
        <a href="profil.html" class="nav-link"><i class="ri-user-3-line"></i><span>Profil</span></a>
    </nav>
<div class="overlay" id="overlay" style="display:none">
    <div class="popup-card" id="popup">
        <div id="loader">
            <div class="spin-container">
                <svg class="spinning-red">
                    <circle class="circle-bg" cx="22.5" cy="22.5" r="20"></circle>
                    <circle class="circle-bar" cx="22.5" cy="22.5" r="20"></circle>
                </svg>
            </div>
        </div>

        <i class="ri-checkbox-circle-fill check-icon" id="checkIcon"></i>
        <i class="ri-close-circle-fill check-icon" id="errorIcon" style="color:#ff3b30;"></i>

        <h3 id="popTitle">Memproses...</h3>
        <p id="popSub">Mohon tunggu</p>
    </div>
</div>

<script>
/* ===============================
   STORAGE HELPER
================================ */
function getUsers() {
    return JSON.parse(localStorage.getItem("users")) || [];
}
function saveUsers(users) {
    localStorage.setItem("users", JSON.stringify(users));
}
function getCurrentUser() {
    const id = localStorage.getItem("currentUser");
    return getUsers().find(u => u.id === id);
}

/* ===============================
   PLAN DATA
================================ */
const PLAN_ORDER = ["MAGANG", "V1", "V2", "V3", "V4", "V5", "V6", "V7"];

const PLAN_RULES = {
    MAGANG: { harga: 0, tugas: 3 },
    V1: { harga: 320000, tugas: 3 },
    V2: { harga: 780000, tugas: 5 },
    V3: { harga: 1820000, tugas: 8 },
    V4: { harga: 3290000, tugas: 12 },
    V5: { harga: 8250000, tugas: 20 },
    V6: { harga: 20150000, tugas: 30 },
    V7: { harga: 50450000, tugas: 45 }
};

/* ===============================
   INIT BUTTON
================================ */
/* ===============================
   INIT BUTTON (DENGAN LOGIKA EXPIRED MAGANG)
================================ */
document.addEventListener("DOMContentLoaded", () => {

    const user = getCurrentUser();
    if (!user) {
        window.location.href = "daftar.html?action=login";
        return;
    }

    const activeIndex = PLAN_ORDER.indexOf(user.planAktif);

    document.querySelectorAll(".btn-join").forEach(btn => {
        const plan = btn.dataset.plan;
        const planIndex = PLAN_ORDER.indexOf(plan);

        // RESET STATUS
        btn.disabled = false;
        btn.classList.remove("active", "disabled");

        // 1. LOGIKA KHUSUS MAGANG (EXPIRED)
        // Jika plan aktif saat ini adalah MAGANG dan user sudah menyelesaikan tugas (limit tercapai)
        if (user.planAktif === "MAGANG" && plan === "MAGANG") {
            if (user.tugas.hariIni >= user.tugas.limit) {
                btn.innerText = "Selesai/Ditutup";
                btn.classList.add("disabled");
                btn.disabled = true;
                btn.style.background = "#222";
                return; // Berhenti di sini untuk Magang yang sudah habis
            }
        }

        // 2. PLAN AKTIF (NON-MAGANG ATAU MAGANG YANG MASIH ADA TUGAS)
        if (plan === user.planAktif) {
            btn.innerText = "Aktif";
            btn.classList.add("active");
            btn.disabled = true;
            return;
        }

        // 3. PLAN DI BAWAH (LEVEL LEBIH RENDAH DARI YANG AKTIF)
        if (planIndex < activeIndex) {
            btn.innerText = "Ditutup";
            btn.classList.add("disabled");
            btn.disabled = true;
            return;
        }

        // 4. PLAN DI ATAS (BISA DIBELI)
        btn.addEventListener("click", () => beliPlan(plan));
    });
});

/* ===============================
   POPUP CONTROL
================================ */
function showPopupLoading() {
    document.getElementById("overlay").style.display = "flex";
    document.getElementById("popup").classList.add("show");

    document.getElementById("loader").style.display = "block";
    document.getElementById("checkIcon").style.display = "none";
    document.getElementById("errorIcon").style.display = "none";

    document.getElementById("popTitle").innerText = "Memproses...";
    document.getElementById("popSub").innerText = "Mohon tunggu";
}

function showPopupResult(success, title, subtitle) {
    document.getElementById("loader").style.display = "none";
    document.getElementById(success ? "checkIcon" : "errorIcon").style.display = "block";

    document.getElementById("popTitle").innerText = title;
    document.getElementById("popSub").innerText = subtitle;

    setTimeout(() => {
        window.location.href = "profil.html";
    }, 1500);
}

/* ===============================
   BELI PLAN
================================ */
/* ===============================
   BELI PLAN (DENGAN FORMAT KHUSUS)
================================ */
function beliPlan(planName) {
    const user = getCurrentUser();
    const plan = PLAN_RULES[planName];

    showPopupLoading();

    setTimeout(() => {
        // 1. CEK SALDO DEPOSIT
        if (plan.harga > 0 && user.saldo.deposit < plan.harga) {
            showPopupResult(false, "Aktivasi Gagal", "Saldo tidak mencukupi!");
            return;
        }

        // --- LOGIKA FORMAT WAKTU: 31 Des 2025 15.24.09 ---
        const now = new Date();
        const bulanIndo = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Agu", "Sep", "Okt", "Nov", "Des"];
        const waktuCustom = `${String(now.getDate()).padStart(2, '0')} ${bulanIndo[now.getMonth()]} ${now.getFullYear()} ${String(now.getHours()).padStart(2, '0')}.${String(now.getMinutes()).padStart(2, '0')}.${String(now.getSeconds()).padStart(2, '0')}`;
        // ------------------------------------------------

        // 2. POTONG SALDO DEPOSIT
        if (plan.harga > 0) {
            user.saldo.deposit -= plan.harga;
        }

        // 3. UPDATE PLAN & REFRESH TUGAS
        user.planAktif = planName;
        user.tugas.hariIni = 0; 
        user.tugas.limit = plan.tugas; 

        // 4. CATAT DI RIWAYAT (FORMAT SESUAI PERMINTAAN)
        // 4. CATAT DI RIWAYAT (FORMAT SESUAI PERMINTAAN)
        user.catatan.push({
            id: "CAT-" + Date.now(),
            tipe: "aktivasi_plan",
            judul: "Aktivasi " + planName,          
            keterangan: "Upgrade ke level " + planName,   
            tanggal: waktuCustom,                   
            // MODIFIKASI DISINI: 
            // Jika planName adalah MAGANG, paksa kirim string "-0" agar terdeteksi negatif oleh sistem riwayat
            total: planName === "MAGANG" ? "-0" : -plan.harga,                     
            status: "Berhasil"
        });

        // 5. SIMPAN KE LOCALSTORAGE
        const allUsers = getUsers().map(u => u.id === user.id ? user : u);
        saveUsers(allUsers);

        showPopupResult(true, "Aktivasi Berhasil", "Berhasil menjadi "+ planName);

    }, 1200);
}
</script>
</body>
</html>